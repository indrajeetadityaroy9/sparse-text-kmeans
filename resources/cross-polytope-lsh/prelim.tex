\section{Preliminaries}

We use $\|.\|$ to denote the Euclidean (a.k.a. $\ell_2$) norm on $\Rbb^d$. We also use $S^{d-1}$ to denote the unit sphere in $\Rbb^d$ centered in the origin.
The Gaussian distribution with mean zero and variance of one is denoted by $N(0, 1)$.
Let $\mu$ be a normalized Haar measure on $S^{d-1}$  (that is, $\mu(S^{d-1}) = 1$).
Note that $\mu$ it corresponds to the uniform distribution over
$S^{d-1}$. We also let $u \sim S^{d-1}$ be a point sampled from $S^{d-1}$ uniformly at random.
For $\eta \in \Rbb$ we denote
$$
\Phi_c(\eta) = \underset{X \sim N(0, 1)}{\mathrm{Pr}}[X \geq \eta] = \frac{1}{\sqrt{2 \pi}} \int_{\eta}^{\infty} e^{-t^2 / 2} \, dt.
$$

We will be interested in the Near Neighbor Search on the sphere $S^{d-1}$ with respect to the Euclidean distance.
Note that the angular distance can be expressed via the Euclidean distance between normalized vectors, so our results
apply to  the angular distance as well.

\begin{definition}

  Given an $n$-point dataset $P \subset S^{d-1}$ on the sphere, the goal
  of the \emph{$(c, r)$-Approximate Near Neighbor problem (ANN)}
  is to build a data structure that, given a query $q \in S^{d-1}$
  with the promise that there exists a datapoint $p \in P$ with $\|p - q\| \leq r$,
  reports a datapoint $p' \in P$ within distance $cr$ from $q$.
\end{definition}

\begin{definition}
    We say that a hash family $\mathcal{H}$ on the sphere $S^{d-1}$ is 
    \emph{$(r_1, r_2, p_1, p_2)$-sensitive}, if
    for every $p, q \in S^{d-1}$ one has
    $\underset{h \sim \mathcal{H}}{\mathrm{Pr}}[h(x) = h(y)] \geq p_1$ if $\|x - y\| \leq r_1$,
    and $\underset{h \sim \mathcal{H}}{\mathrm{Pr}}[h(x) = h(y)] \leq p_2$ if $\|x - y\| \geq r_2$,
\end{definition}

It is known~\cite{HIM12} that an \emph{efficient} $(r, cr, p_1, p_2)$-sensitive hash family implies
a data structure for $(c, r)$-ANN with space $O(n^{1 + \rho}/p_1 + dn)$ and query time $O(d \cdot n^{\rho}/p_1)$,
where $\rho = \frac{\log(1 / p_1)}{\log(1 / p_2)}$.
